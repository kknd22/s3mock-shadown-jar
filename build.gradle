buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.1'
    }
}

apply plugin: 'scala'
apply plugin: "com.github.johnrengelman.shadow"
apply plugin: 'maven'
apply plugin: 'maven-publish'

repositories {
    jcenter()
}

dependencies {
    compile 'io.findify:s3mock_2.11:0.2.4'
    compile "org.rogach:scallop_2.11:3.1.1"

    runtime 'org.slf4j:slf4j-simple:1.7.25'
}

jar {
    manifest {
        attributes(
                'Class-Path': configurations.compile.collect { it.getName() }.join(' '),
                'Main-Class': 'org.mock.addon.s3.S3MockStandaloneServer'
        )
    }
}

shadowJar {
    transform(com.github.jengelman.gradle.plugins.shadow.transformers.AppendingTransformer) {
        resource = 'reference.conf'
    }
    baseName = 's3mock-shadow'
    classifier = ''
}

publishing {
    publications {
        shadow(MavenPublication) {
            artifact shadowJar
            artifactId  = 's3mock-shadow'
        }
    }
}